(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4847],{7171:function(e,t,n){Promise.resolve().then(n.bind(n,27817))},27817:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(57437),s=n(824),a=n(76965),i=n(60274),o=n(16463),l=n(2265),c=n(41942),u=function(e){let{question:t,onChartTypeChange:n}=e;return(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,r.jsx)(c.ffH,{className:"cursor-pointer"}),t]}),(0,r.jsx)("div",{className:"flex space-x-5",children:(0,r.jsxs)("div",{className:"space-x-1",children:[(0,r.jsx)("label",{className:"text-secondary-300",children:"Chart Type:"}),(0,r.jsxs)("select",{className:"border border-secondary-200 rounded-md p-2 col-span-8 bg-white",id:"chartType",onChange:e=>n(e.target.value),children:[(0,r.jsx)("option",{value:"column",children:"Column"}),(0,r.jsx)("option",{value:"bar",children:"Bar"}),(0,r.jsx)("option",{value:"pie",children:"Pie"}),(0,r.jsx)("option",{value:"line",children:"Line"})]})]})})]})},d=n(37346),p=n(55211);p.kL.register(p.uw,p.f$,p.ZL,p.Dx,p.u,p.De,p.qi,p.od,p.jn);var h=function(e){let{responses:t,chartType:n}=e;console.log(n);let s={labels:t.map(e=>e.response_value),datasets:[{data:t.map(e=>e.count),backgroundColor:["#EF9595","#EFB495","#EFD595","#EBEF95","#A5DD9B","#BB9AB1","#EECEB9"],borderColor:"line"===n?"#EF9595":"",borderWidth:"line"===n?2:0}]},a={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:"pie"===n}},scales:{x:{display:"pie"!==n,ticks:{autoSkip:!1,maxRotation:0,minRotation:0}},y:{display:"pie"!==n,beginAtZero:!0}},barThickness:40};return(0,r.jsx)("div",{className:"h-[30vh] w-[70vw]",children:"bar"===n?(0,r.jsx)(d.$Q,{data:s,options:{...a,indexAxis:"x"}}):"column"===n?(0,r.jsx)(d.$Q,{data:s,options:{...a,indexAxis:"y"}}):"pie"===n?(0,r.jsx)(d.by,{data:s,options:a}):"line"===n?(0,r.jsx)(d.x1,{data:s,options:a}):void 0})},x=function(e){let{questionTitle:t,responses:n,totalResponses:s}=e,[a,i]=(0,l.useState)("column");return(0,r.jsxs)("div",{className:"chart-container flex flex-col w-full h-full bg-white p-5 mb-5 rounded-lg gap-4",children:[(0,r.jsx)(u,{question:t,onChartTypeChange:i}),(0,r.jsx)("div",{className:"flex justify-center ",children:(0,r.jsx)(h,{responses:n,chartType:a})}),(0,r.jsxs)("table",{className:"bg-white border border-gray-300",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100",children:[(0,r.jsx)("th",{className:"py-2 px-4 border-b"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b text-center",children:"Responses"}),(0,r.jsx)("th",{className:"py-2 px-4 border-b text-center",children:"Percent"})]})}),(0,r.jsxs)("tbody",{children:[n.map((e,t)=>{let n=(100*e.count/s).toFixed(2);return(0,r.jsxs)("tr",{className:t%2==0?"bg-gray-50":"bg-white",children:[(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:e.response_value}),(0,r.jsx)("td",{className:"py-2 px-4 border-b text-center",children:e.count}),(0,r.jsxs)("td",{className:"py-2 px-4 border-b text-center",children:[n,"%"]})]},t)}),(0,r.jsxs)("tr",{className:"font-bold",children:[(0,r.jsx)("td",{className:"py-2 px-4 border-b",children:"Total"}),(0,r.jsx)("td",{className:"py-2 px-4 border-b text-center",children:s}),(0,r.jsx)("td",{className:"py-2 px-4 border-b text-center",children:"100.00%"})]})]})]})]})},m=n(85260),f=n(7432),b=n(97501),y=n(81173),g=n.n(y),j=n(94962),v=n(17042);let N={text:["contains","equals","starts with","ends with"],number:["=","!=","<","<=",">",">="],choice:["equals","not equals"]};function w(){var e;let[t,n]=(0,l.useState)([]),[u,d]=(0,l.useState)(!1),[p,h]=(0,l.useState)(""),[y,w]=(0,l.useState)([]),[S,q]=(0,l.useState)([]),[C,k]=(0,l.useState)(""),[_,A]=(0,l.useState)(!1),[D,E]=(0,l.useState)(null),[R,T]=(0,l.useState)(""),[Z,F]=(0,l.useState)(""),[M,O]=(0,l.useState)(""),[P,W]=(0,l.useState)(!1),B=(0,v.Z)();console.log("user is --->",B);let L=null==B?void 0:B.role.map(e=>e.name).includes("Data Analyst"),J=(0,o.useSearchParams)().get("survey_id");(0,l.useEffect)(()=>{Q(),z()},[]);let I=(0,o.useRouter)(),U=e=>{let t=D.find(t=>Number(t.question_id)===Number(e));t?(k(e),T(t.type),F(G(t.type))):T("")},K=e=>["Single line Text Input","Multiline Text Input","Email","Phone Number","Checkbox List","Checkbox List With Other","Radio Grid"].includes(e)?N.text:["Number Input","Number Point","Rating","Date"].includes(e)?N.number:["Radio Button","DropDown","DropDown With Other"].includes(e)?N.choice:[],G=e=>{let t=K(e);return t.length>0?t[0]:""},V=(0,l.useRef)(null),$=async()=>{if(W(!0),!V.current){j.ZP.error("Report not found!");return}let e=new b.ZP("p","mm","a4"),t=V.current.querySelectorAll(".chart-container"),n=10,r=0;for(let s of t)try{let t=await g()(s,{scale:1.5,useCORS:!0}),a=t.toDataURL("image/jpeg",.75),i=190*t.height/t.width;e.addImage(a,"JPEG",10,n,190,i),n+=i+10,r++,2===r&&(e.addPage(),n=10,r=0)}catch(e){console.error("Error capturing chart:",e)}e.save("question-charts.pdf"),W(!1)};async function z(){let e=await (0,i.a2)({survey_id:J,filters:y});console.log("response stats data--->",e.data),e.success&&n(e.data)}async function Q(){let e=await (0,i.LA)({_id:J});console.log("res--------------------------------->",e),E(e.data.questions.map(e=>e))}return(0,r.jsxs)("div",{className:"w-full bg-[#ECF0FA]  min-h-[calc(100vh-80px)] font-medium ",children:[(0,r.jsxs)("nav",{className:"h-16 w-full py-3 px-8 flex justify-between font-semibold ",children:[(0,r.jsx)("div",{className:"text-my-gray-200 items-center my-auto",children:(0,r.jsx)("p",{className:"text-sm ",children:"Analytics"})}),(0,r.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,r.jsx)(a.Z,{onClick:()=>I.push("/admin/data/survey-responses?survey_id=".concat(J)),className:"bg-dark-gray",children:"Responses"}),(0,r.jsx)(a.Z,{onClick:()=>d(!u),className:"",children:"Filters"}),!L&&(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)(a.Z,{className:"gap-2 min-w-52",loading:P,onClick:$,children:[(0,r.jsx)(c.u$v,{})," ",(0,r.jsx)("p",{children:"Export as PDF"})]})}),(0,r.jsx)(a.Z,{onClick:()=>I.back(),className:"bg-dark-gray",children:"Back"})]})]}),u&&(0,r.jsx)("div",{className:"p-4 w-full ",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(a.Z,{className:" flex justify-center items-center w-fit",onClick:()=>A(!0),children:"Data filter +"}),(0,r.jsx)(a.Z,{onClick:()=>z(),className:"w-fit",children:"Apply"})]}),(0,r.jsxs)("select",{onChange:e=>{let t=JSON.parse(e.target.value);y.find(e=>e.question===t.question&&e.operator===t.operator&&e.response===t.response)||w(t=>[...t,JSON.parse(e.target.value)])},value:p,name:"filters",id:"filters",className:"outline-none shadow-lg px-6 py-3 w-[30%] rounded-[20px]",children:[(0,r.jsx)("option",{className:"outline-none shadow-lg px-6 py-3 w-[30%] rounded-[20px]",value:"",disabled:!0,selected:!0,children:"Select filter"}),S&&S.length>0&&S.map(e=>{let t="";if(D){let n=null==D?void 0:D.find(t=>Number(t.question_id)===Number(e.question));n&&(t=n.parameters.question)}let n=JSON.stringify({question:e.question,operator:e.operator,response:e.response});return(0,r.jsx)("option",{value:n,children:"".concat(t," ").concat(e.operator," ").concat(e.response)},e.question)})]}),(0,r.jsx)("div",{className:"flex flex-col",children:y.map(e=>{let t;let n=null==D?void 0:D.find(t=>Number(t.question_id)===Number(e.question));return n&&(t=n.parameters.question),(0,r.jsxs)("div",{className:"flex justify-between mt-5 border border-secondary-200 bg-white rounded-[20px] w-1/2 px-4 py-2",children:[(0,r.jsx)("h2",{children:"".concat(t," ").concat(e.operator," ").concat(e.response)}),(0,r.jsx)("button",{onClick:()=>w(t=>t.filter(t=>!(t.question===e.question&&t.operator===e.operator&&t.response===e.response))),children:(0,r.jsx)(f.$iT,{})})]})})})]})}),(0,r.jsxs)("div",{ref:V,className:"p-5 text-sm text-my-gray-200",children:[t&&t.length>0&&t.map((e,t)=>["Single line Text Input","Multiline Text Input","Email","Phone Number","Number Input","Date"].includes(e.question_type)?null:(0,r.jsx)(x,{questionTitle:e.question,responses:e.responses,totalResponses:e.total_responses},t)),(0,r.jsx)("div",{className:"flex justify-center items-center h-[20vh] w-full",children:(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-bold",children:"Note:"})," The charts are only visible for questions like Radio buttons, checkboxes etc"]})})]}),(0,r.jsx)(m.Z,{open:_,closeModal:()=>A(!1),children:(0,r.jsxs)("div",{className:"min-w-[500px] h-[270px] flex flex-col",children:[(0,r.jsx)("div",{className:"relative z-10 text-primary-300 px-8 py-4 font-semibold border-b border-secondary-300 w-full shadow-md",children:"Add filters"}),(0,r.jsxs)("form",{className:"w-full h-full p-4 flex gap-10 justify-center items-center",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("label",{className:"text-my-gray-200",children:"Question"}),(0,r.jsxs)("select",{onChange:e=>U(e.target.value),value:C,className:"flex items-center border border-secondary-200 rounded-md px-8 py-3 w-full",children:[(0,r.jsx)("option",{value:"",disabled:!0,selected:!0,children:"Select question"}),D&&D.map((e,t)=>(0,r.jsx)("option",{value:e.question_id,className:"text-secondary-300 px-4 py-2 text-left border-b min-w-24 whitespace-nowrap",children:e.parameters.question},t))]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("label",{className:"text-my-gray-200",children:"Operator"}),(0,r.jsxs)("select",{disabled:0===C.trim().length,onChange:e=>F(e.target.value),value:Z,className:"flex items-center border border-secondary-200 rounded-md px-8 py-3 w-full disabled:cursor-not-allowed",children:[(0,r.jsx)("option",{disabled:!0,selected:!0,children:"Select operator"}),K(R).map(e=>(0,r.jsx)("option",{value:e,children:e}))]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("label",{className:"text-my-gray-200",children:"Response"}),(0,r.jsx)("input",{disabled:0===R.trim().length||0===Z.trim().length,onChange:e=>O(e.target.value),value:M,className:"flex items-center border border-secondary-200 rounded-md px-8 py-3 w-full disabled:cursor-not-allowed",type:(null==D?void 0:null===(e=D.find(e=>Number(C)===Number(e.question_id)))||void 0===e?void 0:e.type)==="Date"?"date":"text",placeholder:"Enter response"})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 items-center p-4",children:[(0,r.jsx)(s.Z,{className:"disabled:bg-primary-50 disabled:cursor-not-allowed disabled:text-secondary-100",disabled:0===C.trim().length||0===Z.trim().length||0===M.trim().length,onClick:()=>{q([...S,{question:C,operator:Z,response:M}]),A(!1)},children:"Save Filter"}),(0,r.jsx)(s.Z,{className:"border-red-500 hover:bg-red-500 hover:text-white text-red-500",onClick:()=>A(!1),children:"Cancel"})]})]})})]})}var S=()=>(0,r.jsx)(l.Suspense,{children:(0,r.jsx)(w,{})})},85260:function(e,t,n){"use strict";var r=n(57437),s=n(7583),a=n.n(s);let i={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"0",border:"none",borderRadius:"16px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.3)",zIndex:9999}};a().setAppElement("body"),t.Z=function(e){let{children:t,open:n,closeModal:s}=e;return(0,r.jsx)(a(),{isOpen:n,onRequestClose:s,style:i,contentLabel:"Example Modal",children:t})}},824:function(e,t,n){"use strict";var r=n(57437);n(2265);var s=n(96164);t.Z=function(e){let{children:t,className:n,...a}=e;return(0,r.jsx)("button",{...a,className:(0,s.m6)("border border-primary-300 px-4 py-2 rounded-[20px] text-primary-300 hover:text-white hover:bg-primary-300",n),children:t})}},76965:function(e,t,n){"use strict";var r=n(57437);n(2265);var s=n(12375),a=n(96164);t.Z=function(e){let{children:t,className:n,onClick:i,loading:o,...l}=e;return(0,r.jsx)("button",{...l,onClick:i,className:(0,a.m6)("flex border justify-center items-center text-white bg-primary-300 px-10 h-[50px] py-3 rounded-[20px] hover:bg-orange-500 transition-all duration-200 ease-ease-in-out",n),children:o?(0,r.jsx)(s.Z,{speedMultiplier:1.25,color:"#FFFFFF",size:26}):t})}},17042:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(95650),s=n(2265);function a(){let[e,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=(0,r.a_)();e&&t(e)},[]),e}},60274:function(e,t,n){"use strict";n.d(t,{Gn:function(){return u},LA:function(){return c},Vb:function(){return a},a2:function(){return l},ez:function(){return i},tB:function(){return o}});var r=n(1633),s=n(38472);let a=async e=>{try{let t={method:"POST",url:"".concat(r.M6,"/").concat(r.TK),headers:{"Content-Type":"application/json"},data:e},n=await s.Z.request(t);return console.log(n),n.data}catch(e){return{success:!1,message:"Something Went Wrong",error:e}}},i=async e=>{try{let t={method:"POST",url:"".concat(r.M6,"/").concat(r.Dy,"?_id=").concat(e._id),headers:{"Content-Type":"application/json"},data:e.formData};return(await s.Z.request(t)).data}catch(e){return{success:!1,message:"Something Went Wrong",error:e}}},o=async e=>{try{let t=e.page||1,n=e.limit||10,a=e.filter||"",i=e.created_by,o=e.sortBy,l=e.sortOrder,c=e.published;"published"===e.published?c=!0:"unpublished"===e.published?c=!1:"all"===e.published&&(c=void 0);let u={method:"GET",url:"".concat(r.M6,"/").concat(r.it,"?filter=").concat(a,"&page=").concat(t,"&limit=").concat(n,"&sortBy=").concat(o,"&sortOrder=").concat(l,"&published=").concat(c,"&created_by=").concat(i)},d=await s.Z.request(u);return console.log("response from networks---->",d),d.data}catch(e){return{success:!1,message:"Something Went Wrong",error:e}}},l=async e=>{try{e.page,e.limit,e.filter,e.created_by,e.sortBy,e.sortOrder,e.published,"published"===e.published||"unpublished"===e.published||e.published;let t={method:"GET",url:"".concat(r.M6,"/").concat(r.VJ),params:{survey_id:e.survey_id,filters:e.filters}},n=await s.Z.request(t);return console.log(n),n.data}catch(e){return{success:!1,message:"Something Went Wrong",error:e}}},c=async e=>{try{let t={method:"GET",url:"".concat(r.M6,"/").concat(r.A5,"?_id=").concat(e._id)};return(await s.Z.request(t)).data}catch(e){return{success:!1,message:"Something Went Wrong",error:e}}},u=async e=>{try{let t={method:"POST",url:"".concat(r.M6,"/").concat(r.dt),data:e},n=await s.Z.request(t);return console.log(n),n.data}catch(e){return{success:!1,message:"Something Went Wrong",error:e}}}},95650:function(e,t,n){"use strict";n.d(t,{Sg:function(){return i},aF:function(){return a},a_:function(){return o},p6:function(){return s}});let r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function s(e){let t=new Date(e),n=String(t.getDate()).padStart(2,"0"),s=r[t.getMonth()],a=t.getFullYear();return"".concat(n,"-").concat(s,"-").concat(a)}function a(e,t){return e.length>t?e.slice(0,t)+"...":e}function i(e){let t=new Date(e),n=String(t.getDate()).padStart(2,"0"),s=r[t.getMonth()];return"".concat(n," ").concat(s)}function o(){{let e=localStorage.getItem("jwt");return e?JSON.parse(atob(e.split(".")[1])):null}}},1633:function(e,t,n){"use strict";n.d(t,{A5:function(){return j},Dy:function(){return g},EK:function(){return c},HA:function(){return S},L5:function(){return k},M6:function(){return r},ND:function(){return O},Ny:function(){return Z},Pn:function(){return h},SR:function(){return a},TK:function(){return y},Tp:function(){return s},Tv:function(){return i},UY:function(){return I},VH:function(){return P},VJ:function(){return C},Wy:function(){return G},Yn:function(){return m},d1:function(){return J},dt:function(){return v},ht:function(){return x},it:function(){return N},jC:function(){return q},jV:function(){return E},ls:function(){return U},mW:function(){return F},nM:function(){return W},pQ:function(){return V},pX:function(){return f},py:function(){return K},q6:function(){return R},qJ:function(){return b},ql:function(){return M},r1:function(){return T},rO:function(){return _},rd:function(){return o},sC:function(){return l},sI:function(){return A},sN:function(){return d},tm:function(){return u},tt:function(){return p},vx:function(){return w},we:function(){return L},x4:function(){return D},xD:function(){return B}});let r="https://survey-3uf0.onrender.com",s="api/user/getUser",a="api/user/getAllUsers",i="api/user/addUsers",o="api/user/addMultipleUsers",l="api/user/updateUser",c="api/user/updateUsers",u="api/chatroom/getAllChatsData",d="api/user/getSupervisorCollectors",p="api/user/getAllKaryakarta",h="api/user/getKaryakarta",x="api/user/createKaryakarta",m="api/user/updateKaryakarta",f="api/user/getUsersByAcList",b="api/user/updateMultipleKaryakarta",y="api/survey/saveSurvey",g="api/survey/updateSurvey",j="api/survey/getSurvey",v="api/survey/deleteSurvey",N="api/survey/getAllSurveys",w="api/response/saveResponses",S="api/response/getAllSurveyResponses",q="api/response/getAllResponses",C="api/response/getSurveyResponseStats",k="api/response/updateResponse",_=["Contact Form","Address"],A="api/dashboard",D="api/auth/login",E="api/auth/forgotPassword",R="api/auth/resetPassword",T="api/auth/adminLogin",Z="api/role/allRoles",F="api/role/roles",M="api/role/create",O="api/role/update",P="api/role/delete",W="api/todo/create",B="api/todo/todo",L="api/todo/todos",J="api/todo/update",I="api/todo/delete",U="675985aaa6b36c1fa78d5517",K="671f997d38863c2bfc859e76",G="675a92c24bbe3577d16bcb64",V=["675985aaa6b36c1fa78d5517","672bbdbfbdbe172165452e7d","671f999c38863c2bfc859e7a","675a92c24bbe3577d16bcb64","675bece5305e5a3192324a7a","675bed08305e5a3192324a7c"]}},function(e){e.O(0,[7699,4574,7674,2505,7337,8472,4962,9413,1181,5746,477,2971,7023,1744],function(){return e(e.s=7171)}),_N_E=e.O()}]);