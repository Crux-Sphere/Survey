(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8830],{25410:function(e,s,t){Promise.resolve().then(t.bind(t,8877))},8877:function(e,s,t){"use strict";t.r(s);var l=t(57437),n=t(76965),a=t(81382),r=t(61316),i=t(2265),c=t(60152),d=t(16463),o=t(41942),x=t(84298),u=t(824),p=t(85260),m=t(88726),h=t(95650),b=t(80106),f=t(63872),j=t(77744),y=t(7432);let g={text:["contains","equals","starts with","ends with"],number:["=","!=","<","<=",">",">="],choice:["equals","not equals"]};function N(){var e;let[s,t]=(0,i.useState)(null),[N,w]=(0,i.useState)(null),[v,S]=(0,i.useState)([]),[q,C]=(0,i.useState)(!1),[D,_]=(0,i.useState)(!1),[k,Z]=(0,i.useState)(""),[M,E]=(0,i.useState)([]),[F,O]=(0,i.useState)(""),[R,A]=(0,i.useState)(""),[P,I]=(0,i.useState)(""),[L,B]=(0,i.useState)(""),[J,U]=(0,i.useState)(""),[W,T]=(0,i.useState)([]),[Y,z]=(0,i.useState)([]),[G,K]=(0,i.useState)(!0),[Q,H]=(0,i.useState)(!1),[V,$]=(0,i.useState)(null),[X,ee]=(0,i.useState)(null),[es,et]=(0,i.useState)(!1),[el,en]=(0,i.useState)(null),[ea,er]=(0,i.useState)(null),ei=(0,d.useSearchParams)().get("survey_id"),ec=(0,d.useRouter)(),{isLoaded:ed}=(0,j.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyAAOwDBvpg5ZDv5JFG-CoDW23GsKkOPeuA"});async function eo(){let e,t;s&&N&&(e=new Date(s||""),t=new Date(N||""),e.setDate(e.getDate()+1),t.setDate(t.getDate()+1));let l={surveyId:ei,startDate:e,endDate:t,userId:F,filters:W};H(!0);let n=await (0,c.K7)(l);z(n.data),n.data&&n.data.length>0&&en(n.data[0].responses.map(e=>({question:e.question,question_id:e.question_id}))),H(!1)}async function ex(){H(!0);let e=await (0,x.AW)({});console.log(e.data),S(e.data),H(!1)}(0,i.useEffect)(()=>{eo(),ex()},[G]);let eu=()=>{C(!1),ep()},ep=()=>{A(""),I(""),B("")},em=e=>["Single line Text Input","Multiline Text Input","Email","Phone Number","Checkbox List","Checkbox List With Other"].includes(e)?g.text:["Number Input","Number Point","Rating","Date"].includes(e)?g.number:["Radio Button","DropDown","DropDown With Other"].includes(e)?g.choice:[],eh=e=>{let s=em(e);return s.length>0?s[0]:""},eb=e=>{var s;let t=null===(s=Y[0])||void 0===s?void 0:s.responses.find(s=>s.question_id===Number(e));t?(A(e),Z(t.question_type),I(eh(t.question_type))):Z("")};return(0,l.jsxs)("div",{className:"w-full bg-my-gray-100 font-medium",children:[(0,l.jsxs)("nav",{className:"h-16 bg-white w-full py-3 px-8 flex justify-between shadow-md font-semibold",children:[(0,l.jsx)("div",{className:"text-my-gray-200 items-center my-auto",children:(0,l.jsx)("p",{className:"text-sm",children:"Survey Response"})}),(0,l.jsxs)("div",{className:"flex space-x-2 text-black text-base font-semibold",children:[(0,l.jsx)(n.Z,{className:"rounded-lg px-4 py-2",children:"Export to Excel"}),(0,l.jsx)(n.Z,{className:"rounded-lg px-4 py-2",children:"Export to CSV"}),(0,l.jsx)(n.Z,{className:"rounded-lg px-4 py-2",children:"Configure Fields"}),(0,l.jsx)(a.Z,{onClick:()=>ec.back(),className:"rounded-lg px-4 py-2",children:"Back"})]})]}),(0,l.jsx)("div",{className:"p-5 font-semibold text-sm text-my-gray-200",children:(0,l.jsx)("div",{className:"bg-white space-y-4 rounded-lg px-4 py-6 shadow-md",children:(0,l.jsxs)("div",{className:"w-[780px] space-y-8 pb-6 ",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h1",{className:"text-my-gray-200",children:"Filters"}),(0,l.jsxs)("select",{onChange:e=>{let s=JSON.parse(e.target.value);W.find(e=>e.question===s.question&&e.operator===s.operator&&e.response===s.response)||T(s=>[...s,JSON.parse(e.target.value)])},value:J,name:"filters",id:"filters",className:"border w-full shadow-lg rounded-lg px-4 py-2",children:[(0,l.jsx)("option",{value:"",disabled:!0,selected:!0,children:"Select filter"}),M&&M.length>0&&M.map(e=>{let s="";if(Y&&Y.length>0){let t=Y[0].responses.find(s=>Number(s.question_id)===Number(e.question));t&&(s=t.question)}let t=JSON.stringify({question:e.question,operator:e.operator,response:e.response});return(0,l.jsx)("option",{value:t,children:"".concat(s," ").concat(e.operator," ").concat(e.response)},e.question)})]})]}),(0,l.jsx)("div",{className:"flex flex-col gap-2",children:W.map(e=>{var s;let t;let n=null===(s=Y[0])||void 0===s?void 0:s.responses.find(s=>Number(s.question_id)===Number(e.question));return n&&(t=n.question),(0,l.jsxs)("div",{className:"flex justify-between w-full border border-secondary-200 rounded-sm px-4 py-2",children:[(0,l.jsx)("h2",{children:"".concat(t," ").concat(e.operator," ").concat(e.response)}),(0,l.jsx)("button",{onClick:()=>T(s=>s.filter(s=>s.question!==e.question&&s.operator!==e.operator&&s.response!==e.response)),children:(0,l.jsx)(y.$iT,{})})]})})}),(0,l.jsxs)("div",{className:"flex justify-between space-x-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-my-gray-200 mb-2",children:"Date Range"}),(0,l.jsx)("div",{className:"w-full border border-my-gray-200 flex items-center rounded-lg",children:(0,l.jsx)(r.Z,{className:"w-[352px] h-10",startDate:s,endDate:N,setStartDate:t,setEndDate:w})})]}),(0,l.jsxs)("div",{className:"flex flex-col space-y-2 w-[352px]",children:[(0,l.jsx)("h1",{className:"text-my-gray-200",children:"Selected User"}),(0,l.jsxs)("select",{onChange:e=>O(e.target.value),value:F,name:"selected-user",id:"selected-user",className:"border h-10 w-[352px] border-my-gray-200 rounded-lg px-4 py-2",children:[(0,l.jsx)("option",{value:"",disabled:!0,selected:!0,children:"Select user"}),v&&v.length>0&&v.map(e=>(0,l.jsx)("option",{value:e._id,children:e.name},e._id))]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("h1",{className:"text-my-gray-200",children:"Data Filter"}),(0,l.jsx)(n.Z,{className:"w-10 h-10 flex justify-center items-center",onClick:()=>{C(!0)},children:"+"})]}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)(a.Z,{onClick:()=>{t(null),w(null),O(""),T([]),K(!G)},className:"rounded-lg border-my-gray-200 bg-white px-4 py-2",children:"Reset"}),(0,l.jsx)(n.Z,{disabled:0===W.length&&!F.trim()&&!s&&!N,onClick:()=>{if(s&&!N||N&&!s){m.ZP.error("Please select a complete date range!");return}eo()},className:"rounded-lg px-4 py-2 disabled:cursor-not-allowed disabled:bg-blue-100 disabled:text-secondary-100",children:"Apply"})]})]})})}),Q&&(0,l.jsx)(b.Z,{className:"h-[30vh] w-full flex justify-center items-center"}),!Q&&Y&&Y.length>0?(0,l.jsx)("div",{className:"overflow-x-auto rounded-t-2xl border border-secondary-200 mx-4",children:(0,l.jsxs)("table",{className:"min-w-full table-auto",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-secondary-100",children:[(0,l.jsx)("td",{className:"min-w-24 px-4 py-2 border-b text-center"}),(0,l.jsx)("td",{className:"min-w-24 px-4 py-2 border-b text-center"}),(0,l.jsx)("td",{className:"text-secondary-300 px-4 py-2 border-b min-w-24 whitespace-nowrap text-center",children:"Response date"}),(0,l.jsx)("td",{className:"text-secondary-300 px-4 py-2 border-b min-w-24 whitespace-nowrap text-center",children:"User"}),Y&&Y.length>0&&Y[0].responses.map((e,s)=>(0,l.jsxs)("td",{className:"gap-2 text-secondary-300 px-4 py-2 border-b min-w-24 whitespace-nowrap text-center",children:[V!==e.question_id?(0,h.aF)(e.question,10):e.question,(0,l.jsx)("button",{className:"text-primary-300 text-sm ml-2",onClick:()=>$(e.question_id),children:V!==e.question_id&&e.question.length>10?"More":""}),(0,l.jsx)("button",{className:"text-primary-300 text-sm ml-2",onClick:()=>$(null),children:V===e.question_id&&e.question.length>10?"Less":""})]},s))]})}),(0,l.jsx)("tbody",{className:"bg-white",children:Y&&Y.map((e,s)=>{var t;return(0,l.jsxs)("tr",{onClick:()=>{ee(e),_(!0)},className:"cursor-pointer",children:[(0,l.jsx)("td",{className:"min-w-24 px-4 py-2 border-b text-center",children:(0,l.jsx)(n.Z,{onClick:e=>{e.stopPropagation(),et(!0)},children:(0,l.jsx)(f.GUT,{})})}),(0,l.jsx)("td",{className:"min-w-24 px-4 py-2 border-b text-center",children:(0,l.jsx)(o.dSq,{})}),(0,l.jsx)("td",{className:"min-w-24 px-4 py-2 border-b text-center",children:(0,h.p6)(e.createdAt)}),(0,l.jsx)("td",{className:"min-w-44 whitespace-nowrap px-4 py-2 border-b text-center",children:(null===(t=v.find(s=>s._id===e.user_id))||void 0===t?void 0:t.name)||"-"}),e.responses.map((e,s)=>(0,l.jsx)("td",{className:"px-4 py-2 border-b min-w-44 whitespace-nowrap text-center",children:(0,h.aF)(e.response,20)||"-"},s))]},s)})})]})}):!Q&&(0,l.jsx)("div",{className:"flex w-full justify-center items-center h-[30vh]",children:(0,l.jsx)("p",{children:"No responses found"})}),(0,l.jsx)(p.Z,{open:q,closeModal:eu,children:(0,l.jsxs)("div",{className:"min-w-[500px] h-[270px] flex flex-col",children:[(0,l.jsx)("div",{className:"relative z-10 text-primary-300 px-8 py-4 font-semibold border-b border-secondary-300 w-full shadow-md",children:"Create surveys"}),(0,l.jsxs)("form",{className:"w-full h-full p-4 flex gap-10 justify-center items-center",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,l.jsx)("label",{className:"text-my-gray-200",children:"Question"}),(0,l.jsxs)("select",{onChange:e=>eb(e.target.value),value:R,className:"flex items-center border border-secondary-200 rounded-md px-8 py-3 w-full",children:[(0,l.jsx)("option",{value:"",disabled:!0,selected:!0,children:"Select question"}),Y&&Y.length>0&&Y[0].responses.map((e,s)=>(0,l.jsx)("option",{value:e.question_id,className:"text-secondary-300 px-4 py-2 text-left border-b min-w-24 whitespace-nowrap",children:e.question},s))]})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,l.jsx)("label",{className:"text-my-gray-200",children:"Operator"}),(0,l.jsxs)("select",{disabled:0===R.trim().length,onChange:e=>I(e.target.value),value:P,className:"flex items-center border border-secondary-200 rounded-md px-8 py-3 w-full disabled:cursor-not-allowed",children:[(0,l.jsx)("option",{disabled:!0,selected:!0,children:"Select operator"}),em(k).map(e=>(0,l.jsx)("option",{value:e,children:e}))]})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,l.jsx)("label",{className:"text-my-gray-200",children:"Response"}),(0,l.jsx)("input",{disabled:0===k.trim().length||0===P.trim().length,onChange:e=>B(e.target.value),value:L,className:"flex items-center border border-secondary-200 rounded-md px-8 py-3 w-full disabled:cursor-not-allowed",type:"text",placeholder:"Enter response"})]})]}),(0,l.jsxs)("div",{className:"flex gap-3 items-center p-4",children:[(0,l.jsx)(u.Z,{className:"disabled:bg-blue-100 disabled:cursor-not-allowed disabled:text-secondary-100",disabled:0===R.trim().length||0===P.trim().length||0===L.trim().length,onClick:()=>{E([...M,{question:R,operator:P,response:L}]),eu()},children:"Save Filter"}),(0,l.jsx)(u.Z,{className:"border-red-500 hover:bg-red-500 hover:text-white text-red-500",onClick:eu,children:"Cancel"})]})]})}),(0,l.jsx)(p.Z,{open:D,closeModal:()=>_(!1),children:X&&(0,l.jsx)("div",{className:"p-4 h-[60vh] flex justify-center items-center w-[50vw]",children:(0,l.jsxs)("div",{className:"flex h-full w-full justify-center items-center flex-col gap-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 w-full",children:[(0,l.jsxs)("h2",{className:"w-full h-full text-center text-xl font-semibold border-b-2 pb-2",children:[" ","Question"," "]}),(0,l.jsx)("p",{className:"w-full h-full text-center text-xl font-semibold border-b-2 pb-2",children:"Response"})]}),(0,l.jsxs)("div",{className:"flex h-full w-full flex-col overflow-y-auto",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 w-full",children:[(0,l.jsx)("h2",{className:"py-4 bg-blue-100 w-full h-full text-center font-medium",children:"Response by"}),(0,l.jsx)("p",{className:"py-4 bg-blue-100 w-full h-full text-center font-medium",children:(null===(e=v.find(e=>e._id===X.user_id))||void 0===e?void 0:e.name)||"-"})]}),X.responses.map((e,s)=>(0,l.jsxs)("div",{className:"grid grid-cols-2 w-full",children:[(0,l.jsx)("h2",{className:"w-full py-4 h-full text-center ".concat(s%2==0?"bg-blue-50":"bg-blue-100"),children:e.question}),(0,l.jsx)("p",{className:"w-full py-4 h-full text-center ".concat(s%2==0?"bg-blue-50":"bg-blue-100"),children:e.response})]},s))]})]})})}),(0,l.jsx)(p.Z,{open:es,closeModal:()=>et(!1),children:(0,l.jsx)("div",{className:"p-4 h-[60vh] flex justify-center items-center w-[50vw]",children:(0,l.jsx)("div",{className:"flex h-full w-full justify-center items-center flex-col gap-4",children:ed?(0,l.jsx)(j.b6,{mapContainerStyle:{width:"400px",height:"400px"},center:{lat:-3.745,lng:-38.523},zoom:10,onLoad:e=>{console.log("gmap--->",e);let s=new window.google.maps.LatLngBounds;e.fitBounds(s)},onUnmount:e=>{},children:(0,l.jsx)(l.Fragment,{})}):(0,l.jsx)(l.Fragment,{})})})})]})}s.default=()=>(0,l.jsx)(i.Suspense,{children:(0,l.jsx)(N,{})})},81382:function(e,s,t){"use strict";var l=t(57437);t(2265);var n=t(96164);s.Z=function(e){let{children:s,className:t,onClick:a,...r}=e;return(0,l.jsx)("button",{...r,onClick:a,className:(0,n.m6)("border text-black bg-[#E0DCDC] rounded-lg px-4 py-2",t),children:s})}},61316:function(e,s,t){"use strict";t.d(s,{Z:function(){return o}});var l=t(57437),n=t(76235),a=t(36463),r=t.n(a),i=t(28196),c=t(96164),d=t(66648);t(54575);var o=function(e){let{startDate:s,setStartDate:t,endDate:a,setEndDate:o,className:x}=e,u=e=>e?(0,n.WU)(e,"dd-MMM-yyyy"):"",p=e=>{if(!e)return null;let s=new Date(e);return s.setHours(0,0,0,0),s};return(0,l.jsxs)("div",{className:(0,c.m6)("w-fit flex font-medium text-lg px-4 py-2 items-center space-x-2 rounded-lg focus:outline-none cursor-pointer",x),children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(d.default,{src:"/_next/static/media/survey_analytics_calender.a8f69bf6.png",alt:"calender",height:24,width:24})}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(r(),{selected:s,onChange:e=>t(p(e)),dateFormat:"dd.MM.yyyy",scrollableYearDropdown:!0,scrollableMonthYearDropdown:!0,customInput:(0,l.jsx)("div",{className:"relative",children:(0,l.jsx)("input",{type:"text",value:s?u(s):"",onChange:e=>{console.log("inside input")},placeholder:"Select start",className:"my-2 w-[120px] text-center"})})}),(0,l.jsx)(i.OEZ,{className:"inline-block pt-1 text-2xl"}),(0,l.jsx)(r(),{selected:a,onChange:e=>o(p(e)),dateFormat:"dd.MM.yyyy",scrollableYearDropdown:!0,scrollableMonthYearDropdown:!0,customInput:(0,l.jsx)("div",{className:"relative",children:(0,l.jsx)("input",{type:"text",value:a?u(a):"",onChange:e=>{console.log("inside input")},placeholder:"Select end",className:"my-2 w-[120px] text-center"})})})]})]})}}},function(e){e.O(0,[5223,7699,614,1544,4574,7240,1910,8472,6164,3004,4049,8143,8088,7583,822,2971,7023,1744],function(){return e(e.s=25410)}),_N_E=e.O()}]);