(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8182],{30290:function(e,t,s){Promise.resolve().then(s.bind(s,66609))},4815:function(e,t,s){"use strict";var a=s(2265),n=s(38936),l=s(65530),r=function(){return(r=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},o=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)0>t.indexOf(a[n])&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]]);return s},c=[(0,l.i)("PropagateLoader","25% {transform: translateX(-".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(-").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(-").concat(5,"rem) scale(0.5)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-0"),(0,l.i)("PropagateLoader","25% {transform: translateX(-".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(-").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(-").concat(3,"rem) scale(0.6)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-1"),(0,l.i)("PropagateLoader","25% {transform: translateX(-".concat(1,"rem) scale(0.75)}\n    75% {transform: translateX(-").concat(1,"rem) scale(0.75)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-2"),(0,l.i)("PropagateLoader","25% {transform: translateX(".concat(1,"rem) scale(0.75)}\n    75% {transform: translateX(").concat(1,"rem) scale(0.75)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-3"),(0,l.i)("PropagateLoader","25% {transform: translateX(".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(").concat(3,"rem) scale(0.6)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-4"),(0,l.i)("PropagateLoader","25% {transform: translateX(".concat(1,"rem) scale(0.75)}\n    50% {transform: translateX(").concat(3,"rem) scale(0.6)}\n    75% {transform: translateX(").concat(5,"rem) scale(0.5)}\n    95% {transform: translateX(0rem) scale(1)}"),"propogate-5")];t.Z=function(e){var t=e.loading,s=e.color,l=void 0===s?"#000000":s,i=e.speedMultiplier,d=void 0===i?1:i,u=e.cssOverride,p=e.size,m=o(e,["loading","color","speedMultiplier","cssOverride","size"]),f=(0,n.h)(void 0===p?15:p),x=f.value,h=f.unit,g=r({display:"inherit",position:"relative"},void 0===u?{}:u),j=function(e){return{position:"absolute",fontSize:"".concat(x/3).concat(h),width:"".concat(x).concat(h),height:"".concat(x).concat(h),background:l,borderRadius:"50%",animation:"".concat(c[e]," ").concat(1.5/d,"s infinite"),animationFillMode:"forwards"}};return void 0===t||t?a.createElement("span",r({style:g},m),a.createElement("span",{style:j(0)}),a.createElement("span",{style:j(1)}),a.createElement("span",{style:j(2)}),a.createElement("span",{style:j(3)}),a.createElement("span",{style:j(4)}),a.createElement("span",{style:j(5)})):null}},66609:function(e,t,s){"use strict";s.r(t);var a=s(57437),n=s(76965),l=s(81382),r=s(40855),o=s(2265),c=s(60152),i=s(16463),d=s(84298),u=s(88726),p=s(80106),m=s(77744),f=s(60274),x=s(78731),h=s(55691),g=s(95673),j=s(50336),y=s(82744),v=s(64785),b=s(66648),S=s(554),w=s(69824),N=s(1633);function O(){let[e,t]=(0,o.useState)(null),[s,O]=(0,o.useState)(null),[D,P]=(0,o.useState)([]),[X,k]=(0,o.useState)(!1),[M,E]=(0,o.useState)(!1),[Z,_]=(0,o.useState)(""),[R,C]=(0,o.useState)([]),[A,I]=(0,o.useState)(""),[L,F]=(0,o.useState)(""),[q,z]=(0,o.useState)(""),[U,Q]=(0,o.useState)(""),[B,J]=(0,o.useState)([]),[K,G]=(0,o.useState)([]),[T,W]=(0,o.useState)(!0),[Y,H]=(0,o.useState)(!1),[V,$]=(0,o.useState)(null),[ee,et]=(0,o.useState)(null),[es,ea]=(0,o.useState)(!1),[en,el]=(0,o.useState)(null),[er,eo]=(0,o.useState)(!1),[ec,ei]=(0,o.useState)(!1),[ed,eu]=(0,o.useState)(null),[ep,em]=(0,o.useState)(null),[ef,ex]=(0,o.useState)(null),[eh,eg]=(0,o.useState)(null),[ej,ey]=(0,o.useState)(1),[ev,eb]=(0,o.useState)(10),[eS,ew]=(0,o.useState)(1),[eN,eO]=(0,o.useState)(!1),[eD,eP]=(0,o.useState)([]),eX=(0,i.useSearchParams)(),ek=eX.get("survey_id"),eM=eX.get("collector_id"),eE=(0,i.useRouter)(),{isLoaded:eZ}=(0,m.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyAAOwDBvpg5ZDv5JFG-CoDW23GsKkOPeuA"});async function e_(){let t,a;e&&s&&(t=new Date(e||""),a=new Date(s||""),t.setDate(t.getDate()+1),a.setDate(a.getDate()+1));let n={surveyId:ek,startDate:t,endDate:a,userId:eM,filters:B,limit:ev,page:eS};console.log("params are -->",n),H(!0);let l=await (0,c.K7)(n);G(l.data),ey(l.totalPages),console.log("responses of responses ------>",l),l.data&&l.data.length>0&&el(l.data[0].responses.map(e=>({question:e.question,question_id:e.question_id}))),H(!1)}async function eR(){let e=await (0,f.LA)({_id:ek});console.log("current survey-->",e),e.success?(console.log("setting ac_list",e.data.ac_list),eP(e.data.ac_list),eg(e.data.questions.map(e=>e))):u.ZP.error("Error fetching the survey!")}async function eC(){H(!0);let e=await (0,d.AW)({selectedRole:N.py});console.log("users-------->",e.data),P(e.data),H(!1)}async function eA(){H(!0),console.log("ac list is coming  --->",eD);let e=await (0,d.Yx)({ac_list:eD,filter:ed});console.log("panna below-------->",e),em(e),H(!1)}(0,o.useEffect)(()=>{eR(),e_(),eC()},[T,eS,ev]),(0,o.useEffect)(()=>{eD.length>0&&eA()},[ed,eD]);let eI=()=>{k(!1),eL()},eL=()=>{I(""),F(""),z("")},eF=async()=>{try{let t,a;eO(!0),e&&s&&(t=new Date(e||""),a=new Date(s||""),t.setDate(t.getDate()+1),a.setDate(a.getDate()+1));let n={surveyId:ek,startDate:t,endDate:a,userId:eM,filters:B,download:!0},l="response.xlsx",r=await (0,c.kz)(n),o=r.headers["content-disposition"];console.log("header ======>",o);let i=o.split("filename=")[1].replace(/"/g,"");i&&(l=i);let d=window.URL.createObjectURL(new Blob([r.data])),u=document.createElement("a");u.href=d,u.setAttribute("download",l),document.body.appendChild(u),u.click(),document.body.removeChild(u)}catch(e){u.ZP.error("Failed to export to Excel")}finally{eO(!1)}};return null==D||D.map(e=>({value:e._id,label:e.name})),(0,a.jsxs)("div",{className:"flex flex-col min-h-[calc(100vh-80px)] w-full font-medium bg-light-gray",children:[(0,a.jsxs)("nav",{className:"w-full py-3 px-8 flex flex-col gap-10 font-semibold",children:[(0,a.jsx)("h3",{className:"text-[24px] font-semibold",children:"Survey Response"}),(0,a.jsxs)("div",{className:"flex w-full gap-12",children:[(0,a.jsx)(x.Z,{appliedFilters:B,filters:R,responses:K,selectedFilter:U,setAppliedFilters:J,setSelectedFilter:Q,surveyQuestions:eh}),(0,a.jsxs)("div",{className:"flex space-x-2 text-black text-base font-semibold",children:[(0,a.jsx)(n.Z,{loading:eN,onClick:eF,className:"rounded-[20px] h-fit px-4 py-2 w-44 justify-center",children:"Export to Excel"}),(0,a.jsx)(l.Z,{onClick:()=>eE.back(),className:"rounded-[20px] h-fit px-4 py-2",children:"Back"})]})]})]}),(0,a.jsx)("div",{className:"p-5 font-semibold text-sm ",children:(0,a.jsx)("div",{className:"bg-light-gray space-y-4 w-full rounded-lg px-4 py-6",children:(0,a.jsxs)("div",{className:"w-[780px] space-y-8 pb-6 ",children:[(0,a.jsxs)("div",{className:"flex gap-10",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex gap-3 items-center mb-5",children:[(0,a.jsx)("h1",{className:"",children:"Date Range"}),(0,a.jsx)(b.default,{src:S.Z.src,alt:"calender",height:18,width:18})]}),(0,a.jsx)("div",{className:"w-fit",children:(0,a.jsx)(r.Z,{className:"w-[352px] h-10",startDate:e,endDate:s,setStartDate:t,setEndDate:O})})]}),(0,a.jsx)(n.Z,{className:" flex justify-center items-center h-fit self-end",onClick:()=>{k(!0)},children:"Data filter +"})]}),(0,a.jsx)("div",{className:"flex gap-5 items-center",children:(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)(l.Z,{onClick:()=>{t(null),O(null),J([]),W(!T)},className:"bg-dark-gray text-white",children:"Reset"}),(0,a.jsx)(n.Z,{disabled:0===B.length&&!e&&!s,onClick:()=>{if(e&&!s||s&&!e){u.ZP.error("Please select a complete date range!");return}e_()},className:"disabled:cursor-not-allowed disabled:bg-primary-100 disabled:text-secondary-100",children:"Apply"})]})})]})})}),Y&&(0,a.jsx)(p.Z,{className:"h-[30vh] w-full flex justify-center items-center"}),!Y&&K&&K.length>0?(0,a.jsx)(v.Z,{selectedPanna:ef,more:V,responses:K,setMapModalIsOpen:ea,setMore:$,setResponseModalIsOpen:E,setSelectedResponse:et,users:D,assignMode:er,setAssignedMode:eo,getUserResponses:e_,setSelectedPanna:ex}):!Y&&(0,a.jsx)("div",{className:"flex w-full justify-center items-center h-[30vh]",children:(0,a.jsx)("p",{children:"No responses from collector"})}),!Y&&(0,a.jsxs)("div",{className:"flex gap-3 items-center my-4 ml-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"limit-select",className:"mr-2",children:"Show:"}),(0,a.jsxs)("select",{id:"limit-select",value:ev,onChange:e=>{eb(parseInt(e.target.value,10))},className:"p-2 border rounded-md",children:[(0,a.jsx)("option",{value:10,children:"10"}),(0,a.jsx)("option",{value:20,children:"20"}),(0,a.jsx)("option",{value:50,children:"50"}),(0,a.jsx)("option",{value:100,children:"100"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>{ew(eS-1)},disabled:1===eS,className:"p-2 border rounded-md disabled:opacity-50",children:(0,a.jsx)(w.u1R,{})}),(0,a.jsxs)("span",{children:["Page ",eS," of ",ej]}),(0,a.jsx)("button",{onClick:()=>{ew(eS+1)},disabled:eS===ej,className:"p-2 border rounded-md disabled:opacity-50",children:(0,a.jsx)(w.hjJ,{})})]})]}),(0,a.jsx)(h.Z,{modalIsOpen:X,closeModal:eI,surveyQuestions:eh,question:A,questionType:Z,operator:L,response:q,setQuestionType:_,setQuestion:I,setOperator:F,setResponse:z,saveFilter:()=>{C([...R,{question:A,operator:L,response:q}]),eI()}}),(0,a.jsx)(g.Z,{responseModalIsOpen:M,selectedResponse:ee,setResponseModalIsOpen:E,users:D}),(0,a.jsx)(y.Z,{isLoaded:eZ,mapModalIsOpen:es,setMapModalIsOpen:ea}),(0,a.jsx)(j.Z,{assignMode:er,pannaPramukh:ep,selectedPanna:ef,setAssignMode:eo,setSelectedPanna:ex,setUserModal:ei,setUserSearch:eu,userModal:ec,userSearch:ed||""})]})}t.default=()=>(0,a.jsx)(o.Suspense,{children:(0,a.jsx)(O,{})})}},function(e){e.O(0,[5223,5452,7699,4574,1544,7240,1910,8472,8726,9413,1181,8143,4049,2274,1805,8780,8155,198,2971,7023,1744],function(){return e(e.s=30290)}),_N_E=e.O()}]);